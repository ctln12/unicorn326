<div class="row mt-1">
  <div class="col-3">
    <% @chats.each do |chat| %>
      <%= link_to chat_path(chat), class: "chat-tutor", style: "text-decoration: none; color: black;" do %>
        <div style="height: 60px; margin-bottom: 10px; padding-left: 10px; background-color: white; border-radius: 5px;<%= @chat.tutor == chat.tutor ? "font-weight: bold; border-left: 5px solid #167FFB" : "border-left: 5px solid transparent" %>">
          <%= image_tag "https://kitt.lewagon.com/placeholder/users/ssaunier", class: "avatar", style: "margin: 5px; margin-top: 10px;" %>
          <span><%= student_signed_in? ? chat.tutor.first_name : chat.student.first_name %></p>
        </div>
      <% end %>
    <% end %>
  </div>

  <div class="col-9">
    <div style="display: flex; align-items: center;">
      <%= image_tag "https://kitt.lewagon.com/placeholder/users/ssaunier", class: "avatar", style: "width: 56px; height: 56px;" %>
      <div style="padding-left: 15px;">
        <h5 style="margin: 15px 0 0 0;"><strong><%= @chat.tutor.first_name %></strong></h5>
        <p style="font-size: 0.9rem; font-weight: lighter; color: #696969;">Online</p>
      </div>
    </div>
    <div class="chat" data-channel-subscribe="chat" data-chat-id="<%= @chat.id %>" style="height: calc(100vh - 210px); border-radius: 3px 3px 0 0; overflow-y: auto; display: flex; flex-direction: column;">
      <% @messages.each do |message| %>
        <div class="chat-message <%= message.author == (current_student || current_tutor) ? 'left' : '' %>">
          <div class="chat-message-content <%= message.author == (current_student || current_tutor) ? 'reverse' : '' %>">
            <%= image_tag "https://kitt.lewagon.com/placeholder/users/ssaunier", class: "chat-message-content-avatar" %>
            <p class="chat-message-content-text <%= message.author == (current_student || current_tutor) ? 'bg-style' : '' %>">
              <%= message.content %>
            </p>
          </div>
          <div>
            <p class="chat-message-date <%= message.author == (current_student || current_tutor) ? 'indent' : '' %>">
            <%= message.created_at.in_time_zone("CET").strftime("%H:%M") %>
          </p>
          </div>
        </div>
      <% end %>
    </div>

    <%= simple_form_for @message, remote: true, style: "" do |f| %>
      <div style="chat-new-message-content">
        <%= f.input :content, as: :string,
                                 wrapper: false,
                                 label: false, placeholder: "Write your message...",
                                 input_html: {
                                   id: 'chat-new-message-input'
                                 } %>
        <%= f.input :is_student, as: :hidden %>
        <%= f.input :chat_id, as: :hidden  %>
      </div>
      <%= f.submit "Send", id: 'chat-new-message-button' %>
    <% end %>
  </div>
</div>

<div class="d-none" data-role="message-template">
  <div class="chat-message <%= @message.author == (current_student || current_tutor) ? 'left' : '' %>"" >
    <div class="chat-message-content <%= @message.author == (current_student || current_tutor) ? 'reverse' : '' %>">
      <img src="" class="chat-message-content-avatar" alt="" data-role="user-avatar">
      <p class="chat-message-content-text <%= @message.author == (current_student || current_tutor) ? 'bg-style' : '' %>" data-role="message-text"></p>
    </div>
    <div>
      <p class="chat-message-date <%= @message.author == (current_student || current_tutor) ? 'indent' : '' %>" data-role="message-date"></p>
    </div>
  </div>
</div>
